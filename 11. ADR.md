# Architecture decision record
## Системный подход
### Статус
На согласовании

### Контекст
Необходимо решить, какой системный подходи должен быть выбран.

При выборе подхода особое внимание стоит обратить на:
- бизнес-требования;
- комплектацию команды для каждого из подходов;
- стоимость подхода;
- скорость реализации.

Система должна анализировать действия и предпочтения пользователя.
Также надо учитывать, что не определены функции, которые могут быть разработаны в рамках настоящего приложения в будущем, поэтому evolvability является важной характеристикой создаваемой системы.
Сбор метрик, а также: авторизация, анализ покупок пользователя, таргетированная реклама, происходят с использованием внешних систем. Таким образом, еще один важный аспект выбора подхода - integration.

Из существующих подходов сразу были исключены самые сложные, которые не очень подходят для нашего приложения, а именно:
1. Service-oriented architecture. Сложная коммуникация между сервисами, мало специалистов, тяжелая реализация;
2. Service-based architecture. Здесь минусом для создаваемого приложения является единая база данных, которая замедлит работу сервисов по сбору данных о тренировках и метриках пользователя;
3. Space-based architecture. Дорогое, сложное решение. Проектирование приложений с использованием этого подхода менее интуитивно понятно большинству людей и может представлять большую когнитивную нагрузку для оценки и использования; 
4. Event Driven. Ввиду того, что строящееся приложение должно быть максимально легковестным, удобным и быстрым для внедрения, все немалые плюсы данного архитектурного подхода перекрываются основным минусом - высокая сложность разработки, поддержки, отладки, тестирования компенсационных механизмов;
5. Microkernel Architecture. Данный шаблон подходит, когда продукт содержит много точек интеграции и, самое главное, нет явных объектов, которые будут интегрированы в систему в будущем. Таким образом, для разработки приложения данных шаблон не подходит из-за особенностей бизнеса.

Таким образом, выбор осуществляется из следующих вариантов:
1. Monolith;
2. Microservices;
3. Modularized Monolith.

Рассмотрим сравнительные характеристики данных подходов:

|        | Microservices | Modularized Monolith | Monolith | 
|----------------------|---------------|----------------------|----------|
| Ease of Deployment | **            | *****                | *****    |
| Availability | **            | *****                | *****    |
|Evolvability| ****          | *****                | ***      |
|Testability| ***          | *****                | ****     |
|Integrity| *|****| *****    |
|Security |*****|*****| **       |


### Решение
Основываясь на альтернативах в контексте потребностей бизнеса, скорости разработки, стоимости поддержки, простоты создания команды, выбор останавливается в пользу модульного монолита.
Контроль за разделением модулей и красотой кода открывает возможность перехода на микросервисную архитектуру при необходимости.

### Последствия
Основные преимущества заключаются в области разработки и развертывания приложения. 
Дает значительную экономию ресурсов для:
- настройки сред (разработки / тестирования / контроля качества / продуктива);
- совещаниях (одна кодовая база).

Расширяемость и эволюционируемость при данном подходе должны быть на высоком уровне при правильно спроектированном взаимодействии между модулями.
Однако, для этого при проектировании межмодульного взаимодействия следует проявлять особую осторожность и дисциплину. Каждый модуль должен содержать концепции поддоменов в чистоте, требуется избегать скрытых зависимостей даже если придется дублировать часть кода.

## Выбор языка

### Статус
На согласовании

### Контекст
Выбор языка зависит от многих факторов, важнейшими из которых являются:
- количество специалистов на рынке и их стоимость;
- взаимозаменяемость.

На входе от бизнеса мы имеем 5 основных приложений:
- серверная часть приложения;
- iOs мобильное приложение;
- HMS мобильное приложение;
- Android мобильное приложение;
- web-версия портала.

Рассмотрим следующие языки:
- Java — кроссплатформенный язык с поддержкой ООП. Код на Java одинаково запускается и на умном холодильнике, и на микроконтроллере, и на кнопочном телефоне. Всё дело в Java Virtual Machine (JVM) — посреднике между кодом и железом;
- Go, также известный как Golang, - это язык программирования, разработанный Google. Он обеспечивает отличную поддержку многопоточности и поэтому часто используется компаниями, которые в значительной степени полагаются на распределенные системы, а также стартапами в Силиконовой долине. Те, кто хочет присоединиться к стартапу в долине, специализирующемуся на базовых системах, могут захотеть изучить Golang;
- Python - быстрый, простой в использовании и простой в развертывании язык программирования, который широко используется для разработки масштабируемых веб-приложений.

Начнем с последнего - Python:
- Плюсы:
  - Создавать и использовать классы и объекты легко благодаря характеристикам ООП;
  - Обширная библиотечная поддержка;
  - Фокусируется на удобочитаемости кода;
  - Обладает способностью масштабировать даже самые сложные приложения;
  - Идеально подходит для создания прототипов и более быстрого тестирования идей;
  - Открытый исходный код с постоянно растущей поддержкой сообщества;
  - Обеспечивает поддержку множества платформ и систем;
  - Очень прост в освоении и использовании.
- Минусы:
  - Не подходит для мобильных вычислений;
  - Медленнее в силу того, что является интерпретируемым языком программирования;
  - Уровень доступа к базе данных несколько незрелый;
  - Многопоточность не очень хороша из-за GIL (глобальная блокировка интерпретатора).

Java:
- Плюсы:
  - Обилие библиотек с открытым исходным кодом;
  - Автоматическое выделение памяти и сборка мусора;
  - Следует парадигме ООП;  
  - Имеет систему распределения стека;
  - Высокая степень независимости от платформы благодаря функции JVM;
  - Высокая степень безопасности благодаря исключению явного указателя и включению менеджера безопасности, ответственного за определение доступа к классам;
  - Идеально подходит для распределенных вычислений;
  - Предлагает множество API-интерфейсов для выполнения различных задач, таких как подключение к базе данных, создание сетей, утилиты и синтаксический анализ XML;
  - Поддерживает многопоточность.
- Минусы:
  - Отсутствие шаблонов ограничивает создание высококачественных структур данных;
  - Дорогостоящее управление памятью;
  - Медленнее, чем изначально скомпилированные языки программирования, такие как C и C ++.

GO:
- Плюсы:
  - Статически типизированный язык делает его более безопасным;
  - Более чистый синтаксис облегчает изучение;
  - Обширная стандартная библиотека, предлагающая ряд встроенных функций для работы с примитивными типами;
  - Идеально подходит для создания СПА-салонов (одностраничных приложений);
  - Интеллектуальная документация;
  - Очень быстро, так как он компилируется в машинный код.
- Минусы:
  - Отсутствие виртуальной машины делает сложные программы менее эффективными;
  - Неявные интерфейсы;
  - Не хватает универсальности;
  - Нет библиотеки графического интерфейса;
  - Поддержка малообеспеченных библиотек.

|                                 | Java    | GO               | Python        | 
|---------------------------------|---------|------------------|---------------|
| Средняя заработная плата (т.р.) | 180     | 205              | 200           |
| Сообщество                      | большое | немногочисленное | очень большое |
| Кроссплатформенность            | +       | -                | -             |
| Сложность                       | ***     | **           | *          |


### Решение
Не смотря на сложности в разработке, JAVA является распространенным, удобным, кроссплатформенным решением, которое позволит за относительно невысокую плату сформировать команду разработки.

### Последствия
Необходим выстроенный процесс code-review, который позволит минимизировать риски выпуска некачественного программного обеспечения.
При этом найти специалистов на рынке, как и найти ответы на некоторые вопросы в сообществах, не составит большого труда

